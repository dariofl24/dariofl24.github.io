<html>
<head>
<script type="text/javascript">
// blur the popup as soon as possible
window.blur();

// this sets a setInterval and trys to constantly focus the parent window
try {
var counter = 0;
var timer = setInterval(function () {
parent.window.opener.focus();
try {self.opener.focus();}catch (e){}
counter ++;
// XXX - only run this for a short amount of time
// then clear the timer
if (parent.window.opener.focus() || counter > 20) {
clearInterval(timer);
}
}, 50);
} catch (e) {
}
</script>
</head>
<body>

<style type="text/css">
body {
background-color: #184d6f;
color: white;
font-family: sans-serif;
}
a {
color: yellow;
}
</style>

<script type="text/javascript">
window.blur();
// this is fancy code for dectecting Browser and OS
var BrowserDetect = {
init: function () {
this.browser = this.searchString(this.dataBrowser) || "An unknown browser";
this.version = this.searchVersion(navigator.userAgent)
|| this.searchVersion(navigator.appVersion)
|| "an unknown version";
this.OS = this.searchString(this.dataOS) || "an unknown OS";
},
searchString: function (data) {
for (var i=0;i<data.length;i++)	{
var dataString = data[i].string;
var dataProp = data[i].prop;
this.versionSearchString = data[i].versionSearch || data[i].identity;
if (dataString) {
if (dataString.indexOf(data[i].subString) != -1)
return data[i].identity;
}
else if (dataProp)
return data[i].identity;
}
},
searchVersion: function (dataString) {
var index = dataString.indexOf(this.versionSearchString);
if (index == -1) return;
return parseFloat(dataString.substring(index+this.versionSearchString.length+1));
},
dataBrowser: [
{
string: navigator.userAgent,
subString: "Chrome",
identity: "Chrome"
},
{ 	string: navigator.userAgent,
subString: "OmniWeb",
versionSearch: "OmniWeb/",
identity: "OmniWeb"
},
{
string: navigator.vendor,
subString: "Apple",
identity: "Safari",
versionSearch: "Version"
},
{
prop: window.opera,
identity: "Opera"
},
{
string: navigator.vendor,
subString: "iCab",
identity: "iCab"
},
{
string: navigator.vendor,
subString: "KDE",
identity: "Konqueror"
},
{
string: navigator.userAgent,
subString: "Firefox",
identity: "Firefox"
},
{
string: navigator.vendor,
subString: "Camino",
identity: "Camino"
},
{		// for newer Netscapes (6+)
string: navigator.userAgent,
subString: "Netscape",
identity: "Netscape"
},
{
string: navigator.userAgent,
subString: "MSIE",
identity: "Explorer",
versionSearch: "MSIE"
},
{
string: navigator.userAgent,
subString: "Gecko",
identity: "Mozilla",
versionSearch: "rv"
},
{ 		// for older Netscapes (4-)
string: navigator.userAgent,
subString: "Mozilla",
identity: "Netscape",
versionSearch: "Mozilla"
}
],
dataOS : [
{
string: navigator.platform,
subString: "Win",
identity: "Windows"
},
{
string: navigator.platform,
subString: "Mac",
identity: "Mac"
},
{
string: navigator.userAgent,
subString: "iPhone",
identity: "iPhone/iPod"
},
{
string: navigator.platform,
subString: "Linux",
identity: "Linux"
}
]

};

// run browser dectect code
BrowserDetect.init();

// set all browesers to false by default
var isIE6,
isIE7,
isIE8,
isFirefox2,
isFirefox3,
isChrome,
isSafari = false;

/* Just comment out the browsers you don't want a prompt to run on */

// isIE6 = (BrowserDetect.browser === "Explorer" && BrowserDetect.version === 6);
// isIE7 = (BrowserDetect.browser === "Explorer" && BrowserDetect.version === 7);
isIE8 = (BrowserDetect.browser === "Explorer" && BrowserDetect.version === 8);
isFirefox2 = (BrowserDetect.browser === "Firefox" && BrowserDetect.version === 2);
// isFirefox3 = (BrowserDetect.browser === "Firefox" && BrowserDetect.version === 3);
isChrome = BrowserDetect.browser === "Chrome";
// isSafari = (BrowserDetect.browser === "Safari");

/* by default only have the parent run a confirm for these browsers */

// add more browser checks as needed
if (isFirefox2 || isChrome) {
try {
self.window.opener.confirm('Please continue to explore our website.  When you are done, we will show you a survey in a popup window.', 'Ok');
} catch (e) {
}
}

// get parent window location
var host = parent.window.opener.location.host;

function checkParent(){
// constantly check the connection between the popup and parent
// if broken, assume they're ready to take the survey
try{
var t = setTimeout("checkParent()", 100);
var p = parent.window.opener.location.host;
if (p != host){
throw e;
}
}
catch (e){
clearTimeout(t);
window.screenX = 100;
window.screenY = 100;
promptSurvey();
}
}

function promptSurvey() {
// use a confirm instead of showing html buttons for 'yes' take survey
// only checks browsers if !== true
if (isIE6 ||
isIE7 ||
isIE8 ||
isFirefox2 ||
isFirefox3 ||
isChrome ||
isSafari ||
(BrowserDetect.browser === "Firefox" && BrowserDetect.OS === "Linux")) {
document.getElementById("display").style.display = "none";
document.getElementById("displayChrome").style.display = "none";
var answer = confirm("Ready?  Click the OK to take the survey!");
if(answer) {
gotoSurvey()
} else {
window.close()
}
} else {
// show the html buttons
document.getElementById("display").style.display = "none";
document.getElementById("prompt").style.display = "block";
parent.window.opener.blur();
window.focus();
}
}

function gotoSurvey() {
width = screen.width; //window width (full screen by default)
height = screen.height; //window height (full screen by default)
window.screenX = 0;
window.screenY = 0;
window.resizeTo(width, height);
window.focus();
window.location = "http://static.decipherinc.com/survey/selfserve/a0a/lrw13006";
}

checkParent();
</script>

<div id='display'>
<h3>Survey Window</h3>
<p>Please continue to explore our website.  When you are done, we will show you a survey in this window.</p>
</div>

<div id='displayChrome'>
<p>
<font><b>Please do not close this window.</b></font>
</p>
</div>

<div id='prompt' style='display:none'>
<h3>Ready?  Click the Yes link below to take the survey!</h3>
<p>
<a href='javascript: gotoSurvey()'>Yes</a> <a href='javascript: window.close()'>No</a>
</p>
</div>
</body>
</html>